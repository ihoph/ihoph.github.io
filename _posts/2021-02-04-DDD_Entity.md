---
layout: post
title:  DDD - 엔터티
date:   2021-02-02 11:35:00 +0800
categories: DDD
tag: Architecture
sitemap :
  changefreq : daily
  priority : 1.0
---

도메인 개념의 개별성에 신경을 쓸 때, 그러니까 한 개념을 시스템 내의 나머지 모든 객체와 반드시 구분해야 하는 제약 조건이 있을 때 이를 엔터티로 설계한다.

고유 식별자와 변화 가능성이라는 특징이 엔터티와 값 객체 사이의 차이점이다.

대부분 개념은 값으로 모델링 해야 한다.

일반적 CRUD 만 필요한 CRUD 기반의 시스템에는 그루비 앤 그레일스, 루비 온 레일스 등과 같은 언어가 합리적일 수 있다. 반면 CRUD를 시스템에 잘못 적용하면 후회하게 된다.

복잡성이 증가하면 잘못된 도구 선택에 따른 제약이 생긴다. CRUD 시스템에선 데이터의 포착만으로 정교한 비즈니스 시스템을 생성할 수 없다.

객체를 특성이 아니라 식별자에 따라 구분한ㅋ다면 모델을 정의할 때 이를 우선적으로 다뤄라. 클래스의 정의를 단순하게 유지하면서 수명 주기의 지속성과 식별자에 집중하자.

## 고유 식별자

엔터티 설계 초기엔 고유 식별자의 중심을 이루는 우선적인 특성과 행동을 비롯해 이를 쿼리하는 데 도움을 주는 요소에 의도적으로 집중하고, 우선적 사항을 마무리할 때까진 다른 특성이나 행동을 의도적으로 무시한다.

엔터티를 정의할 때 특성이나 행동에 집중하기보단 엔터티 객체를 식별하거나 매칭해서 찾을 때 사용되는 엔터티 객체의 정의를 가장 기본적인 특성까지 파고들어야 한다. 개념적으로 필수적인 행동과 그 행동에서 필요로 하는 특성만 추가하자.

고유 식별자를 탐색이나 매칭에 사용할 수 있는지 여부는 식별자가 얼마나 사람이 읽기 쉽도록 돼 있는지에 달려 있다.

값 객체는 고유 식별자의 홀더 역할을 할 수 있다. 값 객체는 불변하기 때문에 식별자의 ㅇㅏㄴ정성이 확보되고 식별자의 유형에 따른 모든 행동은 중앙집중화 된다. 식별자 행동의 중심점이 생기면 단순함의 종더와는 상관없이 모델의 다른 부분이나 클라이언트로 노하우가 새나가는 것을 막아준다.

### 일반적 식별자 생성 전략

1. 사용자가 하나 이상의 초기  고유값을 입력, 애플리케이션은 이것이 고유한지 확인
2. 애플리케이션이 고유성이 보장되는 알고리즘을 사용해 식별자 생성
3. 데이터베이스와 같은 영속성 저장소가 고유 식별자 생성
4. 다른 바운디드 컨텍스트에서 먼저 고유 식별자 결정



